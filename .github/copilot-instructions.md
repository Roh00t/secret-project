<!-- AUTOGENERATED: tailor this to the repo and iterate with the maintainers -->
# Copilot / AI Agent Instructions for this repository

**Purpose:** Short, actionable guidance to help an AI coding agent become productive in this repository immediately.

<!-- AUTOGENERATED: tailor this to the repo and iterate with the maintainers -->
# Copilot / AI Agent Instructions for this repository (SafeOps)

Purpose: Short, actionable guidance to help an AI coding agent become productive in this repository immediately. This project contains an early product definition for SafeOps — a mobile-first RAW (Risk Assessment Worksheet) system.

Repo snapshot
- Key file: `README.md` — currently only a project title and short note.
- No detected language manifests (`package.json`, `pyproject.toml`, `go.mod`, `Cargo.toml`, etc.). No existing agent docs before this file.

Immediate steps (in order)
- Read `README.md` and confirm with the owner whether to pick a technology stack.
- Run a manifest scan for common runtimes; if none, propose 1–2 stacks (Node/Express + Postgres or Python/FastAPI + Postgres).
- Search for secrets/config (`.env`, `.env.local`, `secrets/`) and stop & report if found.

Preferred tech stack (owner choice)
- Frontend: **Next.js (React)** — PWA support, SSR for mobile performance, offline-first capabilities.
- Backend: **Node.js + Express** — handles high concurrency and has robust PDF libraries (Puppeteer/PDFKit).
- Language: **TypeScript** — share interfaces (`Venue`, `VenueHazard`, etc.) between front/back.
- Database: **PostgreSQL** — relational integrity for venues, hazards, users.
- ORM: **Prisma** — type-safe DB access and easy relations/queries.

Scaffolding checklist (practical steps agents should follow)
- Preferred repo layout (monorepo):
	- `apps/web` — Next.js frontend
	- `apps/api` — Express backend (TypeScript)
	- `libs/types` — shared TypeScript interfaces (e.g., `Venue`, `RAWSubmission`)
- Add manifests and TS configs: root or per-package `package.json`, `tsconfig.json` for each package.
- Add Prisma schema in `apps/api/prisma/schema.prisma` and generate client in `apps/api/prisma`.
- Environment variables to require and document in `README.md`:
	- `DATABASE_URL`, `JWT_SECRET`, `S3_ENDPOINT`/`S3_BUCKET` (or `MINIO`), `EMAIL_API_KEY`.
- Local dev commands examples (replace `npm` with `pnpm`/`yarn` if preferred):

```bash
# install dependencies
npm install

# run frontend (in project root or from apps/web)
cd apps/web && npm run dev

# run backend (in project root or from apps/api)
cd apps/api && npm run dev

# run prisma migrations (from apps/api)
cd apps/api && npx prisma migrate dev --name init
```

- Testing and CI:
	- Add unit tests for business logic (Jest or Vitest) in `apps/api` and component tests in `apps/web`.
	- Add a simple GitHub Actions workflow that runs `npm ci`, `npx prisma generate`, and unit tests on push.

- Minimal security & privacy checklist for changes:
	- Never commit `.env` or secrets; add `.env.example` documenting required vars.
	- Add PDPA note in `docs/` when storing personal data and document retention policies.

Implementation notes for agents
- Use the PRS canonical names for DB models and routes (e.g., `Venue`, `RAWSubmission`, `/api/v1/raws`).
- Implement JWT auth in `apps/api` and provide an example login route in the README.
- For PDF generation (FR-8), prefer server-side rendering with Puppeteer in `apps/api` and write files to object storage.

Questions before scaffolding
- Do you prefer a monorepo (workspaces) or separate repos per service?
- Which package manager (npm / pnpm / yarn) should I use for scaffolding?


SafeOps: Market Research (summary)
- Target segments: public-sector training & ops (e.g., SPF, SCDF, SAF units), private safety-intensive orgs, facility/venue managers.
- Existing solutions: EHS platforms (SafetyCulture, Cority), generic form builders, internal systems.
- Gaps: no venue hazard memory, no persistent issue tracking or blocking of unsafe venues, no dynamic RAW templates, limited mobile-first workflows, missing safety–facility handover features.
- Validation signals: mandatory compliance, frequent RAWs, repeated hazards, poor satisfaction with current tools, available funding (grants).

Product specification (high level)
- Name: SafeOps — mobile-first RAW system with venue hazard intelligence.
- Users: Safety Officer, Approver/OIC, Facility Manager, Admin.
- Core features: RAW creation (venue-specific), venue hazard registry, issue tracking + blocking unsafe venues, approval workflow, facility manager alerts, incident reporting, PDF export, notifications, venue dashboards.
- Workflow: Officer → Approver → Facility Manager resolves → Venue marked safe.
- Data model hints: User, Venue, RAWTemplate, RAWSubmission, RAWAnswer, VenueHazard, HazardIssue, Incident, AuditLog.
- Platform constraints: Web app (mobile-first) + REST API backend, cloud-hosted, JWT/OAuth2 authentication, PDPA & sensitive-data handling, offline considerations for field use.

Product Requirements Spec (PRS) — key points agents should use when implementing features
- Purpose & goals: digitize RAWs, enforce venue safety, reduce repeated hazards, block unsafe venue usage, provide venue safety memory, clean mobile UX, strong audit trail.
- Functional reqs (for V1): FR-1 Authentication, FR-2 RAW Management, FR-3 Venue Registry, FR-4 Issues Management, FR-5 Approvals, FR-6 Alerts, FR-7 Incidents, FR-8 PDFs, FR-9 Admin console.
- Non-functional reqs: security (PDPA), reliability (offline tolerance), usability (mobile-first), scalability, maintainability.
- Scope for V1: RAWs, Issues, Approvals, Venue dashboards, Notifications, PDFs.
- Dependencies to expect: cloud provider, email service, image/object storage, PDF generator service.

Agent behaviour & conventions for this repo
- Preserve minimal changes: make focused commits that update `README.md` when adding a stack or run instructions.
- When scaffolding a stack: include manifest (`package.json` or `pyproject.toml`), a short `README.md` run section, and at least one unit test for a core endpoint.
- Use the PRS data entities as canonical names for DB models and API routes (e.g., `/api/v1/venues`, `/api/v1/raws`, `/api/v1/issues`).
- Prioritise security & privacy: default to encrypted storage, do not commit secrets, and add PDPA notes to `docs/` if handling personal data.
- Mobile-first UX: provide example responsive pages/components and include simple offline sync strategy (local queue + sync endpoint) in `docs/architecture.md` when proposing implementations.

Examples & explicit suggestions
- Naming: use `Venue`, `RAWTemplate`, `RAWSubmission`, `VenueHazard`, `HazardIssue` as model/table names.
- API patterns: RESTful resource routes with versioning (`/api/v1/...`) and JWT bearer auth.
- PDF: use a server-side generator (wkhtmltopdf, Puppeteer, or a cloud PDF service) and store generated PDFs in object storage.

When unsure, ask these questions before coding
1. Which runtime/stack should I scaffold (Node/Express, Python/FastAPI, etc.)?
2. Which database do you want (Postgres recommended for relations)?
3. Any strict requirements for hosting or identity provider (self-host vs cloud; OAuth2 provider)?

Commit & PR expectations
- Keep PRs small and focused, reference the relevant PRS IDs (e.g., "Implements FR-2 RAW Management").
- Add a short `README.md` snippet for any new services/run commands.

Safety & etiquette
- Do not create or commit secrets. If you detect secrets, notify maintainers and redact them.

If this merged guide misses something specific you want agents to follow (coding style, CI, or preferred frameworks), tell me which conventions to adopt and I will update this file.
